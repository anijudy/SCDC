baronraw2 <- rbind(baron2$cluster, exprs(baron2))
# table(baronraw2[1,])
rownames(baronraw2)[1] <- "GeneSymbol"
baronraw2[1:3,1:5]
write.table(baronraw2, "baron_raw.txt", sep = "\t", quote = F, col.names = F,row.names = T)
# ------------------------------------------
# 6. CIBERSORTx + baron
# ------------------------------------------
cibersortx.baron <- read.csv("CIBERSORTx_fadista_baronraw_Results.csv")
cibersortx.baron.prop <- cibersortx.baron[,2:7]
rownames(cibersortx.baron.prop)<- cibersortx.baron[,1]
res.cs.seger <- getLMpValue(prop_est = cibersortx.seger.prop, method_ = "CIBERSORTx+Segerstolpe")
library(reshape2)
res.cs.seger <- getLMpValue(prop_est = cibersortx.seger.prop, method_ = "CIBERSORTx+Segerstolpe")
res.cs.baron <- getLMpValue(prop_est = cibersortx.baron.prop, method_ = "CIBERSORTx+Baron")
res.cs.baron$pvaldata
res.cs.seger$pvaldata
alldata <- rbind(res.SCDC.seger$meltdata, res.SCDC.ensemble$meltdata,
res.bseqsc.seger$meltdata, res.music.seger$meltdata,
res.bisque.seger$meltdata,
res.SCDC.baron$meltdata,
res.bseqsc.baron$meltdata,
res.music.baron$meltdata,
res.bisque.baron$meltdata,
res.cs.baron$meltdata,
res.cs.seger$meltdata)
allpvalue <- rbind(res.SCDC.seger$pvaldata, res.SCDC.ensemble$pvaldata,
res.bseqsc.seger$pvaldata, res.music.seger$pvaldata,
res.bisque.seger$pvaldata,
res.SCDC.baron$pvaldata,
res.bseqsc.baron$pvaldata,
res.music.baron$pvaldata,
res.bisque.baron$pvaldata,
res.cs.baron$pvaldata,
res.cs.seger$pvaldata)
demopval <- rbind(res.SCDC.seger$demo_pval, res.SCDC.ensemble$demo_pval,
res.bseqsc.seger$demo_pval, res.music.seger$demo_pval,
res.bisque.seger$demo_pval,
res.SCDC.baron$demo_pval,
res.bseqsc.baron$demo_pval,
res.music.baron$demo_pval,
res.bisque.baron$demo_pval,
res.cs.baron$demo_pval,
res.cs.seger$demo_pval)
alldata$method <- as.factor(alldata$method)
save.image("S0116_2.rda")
plot.temp.1 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=10),
axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.2 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=10),
axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
library(ggplot2)
plot.temp.1 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=10),
axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.2 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=10),
axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.1
plot.temp.2
View(demopval)
View(allpvalue)
plot.temp.1 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=10),
axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.2 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=10),
axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.1
plot.temp.2
plot.temp.3 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("MuSiC+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=10),
axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("MuSiC+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("MuSiC+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
pdf("H:/994/SCDC/elsarticle-template/pdfFigures/S0116_2_FADISTA_BENCHMARK.pdf", height = 2.5, width = 6.5)
print(plot.temp.1)
print(plot.temp.2)
print(plot.temp.3)
# print(plot.temp2)
# print(plot.temp3)
# print(plot.temp4)
dev.off()
plot.temp.3 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("MuSiC+Baron","CIBERSORTx+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=10),
axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("MuSiC+Baron","CIBERSORTx+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("MuSiC+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
pdf("H:/994/SCDC/elsarticle-template/pdfFigures/S0116_2_FADISTA_BENCHMARK.pdf", height = 2.5, width = 6.5)
print(plot.temp.1)
print(plot.temp.2)
print(plot.temp.3)
# print(plot.temp2)
# print(plot.temp3)
# print(plot.temp4)
dev.off()
plot.temp.1 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=8),
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=8))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.2 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=8),
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=8))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.3 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("MuSiC+Baron","CIBERSORTx+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=8),
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=8))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("MuSiC+Baron","CIBERSORTx+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("MuSiC+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.1
plot.temp.2
pdf("H:/994/SCDC/elsarticle-template/pdfFigures/S0116_2_FADISTA_BENCHMARK.pdf", height = 2.5, width = 6.5)
print(plot.temp.1)
print(plot.temp.2)
print(plot.temp.3)
# print(plot.temp2)
# print(plot.temp3)
# print(plot.temp4)
dev.off()
plot.temp.1 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=8),
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=8))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0, size = 8)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.1
ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=8),
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=8))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0, size = 2) +
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=8),
axis.text.x = element_text(size=8),
axis.text.y = element_text(size=8))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0, size = 4) +
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.1 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=9),
axis.text.x = element_text(size=9),
axis.text.y = element_text(size=9))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0, size = 4) +
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.2 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=9),
axis.text.x = element_text(size=9),
axis.text.y = element_text(size=9))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0, size = 4)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.3 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("MuSiC+Baron","CIBERSORTx+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=9),
axis.text.x = element_text(size=9),
axis.text.y = element_text(size=9))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("MuSiC+Baron","CIBERSORTx+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("MuSiC+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0, size = 4)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.1
plot.temp.2
pdf("H:/994/SCDC/elsarticle-template/pdfFigures/S0116_2_FADISTA_BENCHMARK.pdf", height = 2.5, width = 6.5)
print(plot.temp.1)
print(plot.temp.2)
print(plot.temp.3)
# print(plot.temp2)
# print(plot.temp3)
# print(plot.temp4)
dev.off()
plot.temp.1 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=9),
axis.text.x = element_text(size=9),
axis.text.y = element_text(size=9))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0, size = 2) +
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.2 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=9),
axis.text.x = element_text(size=9),
axis.text.y = element_text(size=9))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0, size = 2)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.3 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("MuSiC+Baron","CIBERSORTx+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=9),
axis.text.x = element_text(size=9),
axis.text.y = element_text(size=9))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("MuSiC+Baron","CIBERSORTx+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("MuSiC+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0, size = 2)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.1
plot.temp.2
pdf("H:/994/SCDC/elsarticle-template/pdfFigures/S0116_2_FADISTA_BENCHMARK.pdf", height = 2.5, width = 6.5)
print(plot.temp.1)
print(plot.temp.2)
print(plot.temp.3)
# print(plot.temp2)
# print(plot.temp3)
# print(plot.temp4)
dev.off()
plot.temp.1 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=9),
axis.text.x = element_text(size=9),
axis.text.y = element_text(size=9))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Segerstolpe","CIBERSORTx+Segerstolpe", "BseqSC+Segerstolpe", "MuSiC+Segerstolpe","SCDC+Segerstolpe"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0, size = 2.5) +
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.2 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=9),
axis.text.x = element_text(size=9),
axis.text.y = element_text(size=9))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("Bisque+Baron","CIBERSORTx+Baron", "BseqSC+Baron", "MuSiC+Baron","SCDC+Baron"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0, size = 2.5)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.3 <- ggplot(alldata[alldata$variable %in% c("beta") & alldata$method %in% c("MuSiC+Baron","CIBERSORTx+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"),], aes(x=hba1c, y= value)) + geom_point(aes(color = hba1c_class2)) +
geom_smooth(method='lm', se = FALSE, color = "black", lwd = 0.25) +
theme(legend.position = "top", legend.title = element_blank(), # axis.title.x = element_blank(),
legend.box.spacing = unit(0, "mm"),
text = element_text(size=9),
axis.text.x = element_text(size=9),
axis.text.y = element_text(size=9))+#, axis.title.y = element_blank()) +
facet_grid(cols = vars(factor(method, levels = c("MuSiC+Baron","CIBERSORTx+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"))),scales = "free") + #, rows = vars(variable)
geom_text(data = allpvalue[allpvalue$variable %in% c("beta") & allpvalue$method %in% c("MuSiC+Baron","SCDC+Segerstolpe","SCDC+Baron", "SCDC+ENSEMBLE"),],
mapping = aes(x=5.5, y=0.85,label = label),
hjust   = 0.2, vjust   = 0, size = 2.5)+
xlab("HbA1c") + ylab("Proportions") + ylim(c(0,1))
plot.temp.1
plot.temp.2
pdf("H:/994/SCDC/elsarticle-template/pdfFigures/S0116_2_FADISTA_BENCHMARK.pdf", height = 2.5, width = 6.5)
print(plot.temp.1)
print(plot.temp.2)
print(plot.temp.3)
# print(plot.temp2)
# print(plot.temp3)
# print(plot.temp4)
dev.off()
devtools::load_all()
# PUT ALL FUNCTIONS INTO THE R FOLDER
# setwd("..")
# getwd()
setwd("H:/994/SCDC/package/SCDC")
#######################
# load rcpp
#######################
devtools::load_all("")
#######################
# load rcpp
#######################
devtools::load_all()
#######################
# load rcpp
#######################
devtools::load_all("H:/994/SCDC/package/SCDC/src")
#######################
# load rcpp
#######################
devtools::load_all("H:/994/SCDC/package/SCDC")
timesTwo(4)
library(SCDC)
timesTwo(4)
#######################
# load rcpp
#######################
devtools::load_all("H:/994/SCDC/package/SCDC")
library(SCDC)
devtools::load_all("H:/994/SCDC/package/SCDC")
library(SCDC)
#' @useDynLib foo
#' @export
rcpp.hello.world <- function() {
rcpp_hello_world()
}
#' @useDynLib SCDC
#' @export
rcpp.hello.world <- function() {
rcpp_hello_world()
}
devtools::document()
#######################
# load rcpp
#######################
devtools::load_all("H:/994/SCDC/package/SCDC")
library(SCDC)
rcpp.hello.world()
#' @useDynLib SCDC
#' @export
rcpp.hello.world <- function() {
rcpp_hello_world()
}
rcpp.hello.world()
# setwd("/pine/scr/m/e/meichen/SCDC/SCDC")
devtools::document()
# setwd("/pine/scr/m/e/meichen/SCDC/SCDC")
devtools::document()
#######################
# load rcpp
#######################
devtools::load_all("H:/994/SCDC/package/SCDC")
library(SCDC)
rcpp.hello.world()
setwd("H:/994/SCDC/package/SCDC")
# setwd("/pine/scr/m/e/meichen/SCDC/SCDC")
devtools::document()
devtools::load_all("H:/994/SCDC/package/SCDC")
library(SCDC)
rcpp.hello.world()
# setwd("/pine/scr/m/e/meichen/SCDC/SCDC")
devtools::document()
library("SCDC",lib.loc="H:/994/SCDC/package/SCDC/")
library("SCDC",lib.loc="H:/994/SCDC/package/SCDC")
?install.packages
install.packages("SCDC",lib="H:/994/SCDC/package/SCDC")
install.packages("SCDC",lib="H:/994/SCDC/package/SCDC")
library("SCDC",lib.loc="H:/994/SCDC/package/SCDC")
library(SCDC)
#######################
# load rcpp
#######################
devtools::load_all("H:/994/SCDC/package/SCDC")
# setwd("/pine/scr/m/e/meichen/SCDC/SCDC")
devtools::document()
#######################
# load rcpp
#######################
devtools::load_all("H:/994/SCDC/package/SCDC")
library(SCDC)
rcpp.hello.world()
# setwd("/pine/scr/m/e/meichen/SCDC/SCDC")
devtools::document()
#######################
# load rcpp
#######################
devtools::load_all("H:/994/SCDC/package/SCDC")
library(SCDC)
rcpp.hello.world()
library(Rcpp)
sourceCpp(foo.cpp)
sourceCpp("foo.cpp")
sourceCpp("H:/994/SCDC/package/SCDC/src/foo.cpp")
rcpp.hello.world()
install.packages("nnls")
setwd("H:/994/SCDC/data")
library(SCDC)
baron <- readRDS("S0102_BARON.rds")
seger <- readRDS("S0102_SEGER.rds")
xin <- readRDS("S0102_XIN.rds")
pseudo.baron <- generateBulk_allcells(baron, ct.varname = "cluster", sample="sample", ct.sub = NULL)
pseudo.seger <- generateBulk_allcells(seger, ct.varname = "cluster", sample="sample", ct.sub = NULL)
pseudo.xin <- generateBulk_allcells(xin, ct.varname = "cluster", sample="sample", ct.sub = NULL)
pancreas.sc <- list(baron = baron, seger=seger, xin=xin)
ens.baron <- SCDC_ENSEMBLE(pseudo.baron$pseudo_eset, sc.eset.list = pancreas.sc, ct.varname = "cluster",
sample = "sample", ct.sub = c("alpha","beta","delta","gamma","acinar","ductal"),
truep = pseudo.baron$truep)
pseudo.baron <- generateBulk_allcells(baron, ct.varname = "cluster", sample="sample", ct.sub = NULL)
pseudo.seger <- generateBulk_allcells(seger, ct.varname = "cluster", sample="sample", ct.sub = NULL)
pseudo.xin <- generateBulk_allcells(xin, ct.varname = "cluster", sample="sample", ct.sub = NULL)
pancreas.sc <- list(baron = baron, seger=seger, xin=xin)
ens.baron <- SCDC_ENSEMBLE(pseudo.baron$pseudo_eset, sc.eset.list = pancreas.sc, ct.varname = "cluster",
sample = "sample", ct.sub = c("alpha","beta","delta","gamma","acinar","ductal"),
truep = pseudo.baron$truep)
library(L1pack)
library(nnls)
